# cB211.072.64 Inclusive runs


```{r ,include=FALSE}
library(Rose)
library(ggplot2)
library(plotly)
library(knitr)
library(katex)
df <- data.frame(x = 1:5, y = 1:5)    
f1 <- function(df) {
  gg <- ggplot(df, aes(x,y)) + geom_point()
  assign("ggp", plotly::ggplotly(gg), envir=parent.frame())
  #ggp
  df    # NOT returning a plot
}
res1 <- f1(df)
ggp   # Let knit handle the plot
```

## Masses from the run with tins=48-64

```{r, echo=FALSE, results='asis', warning=FALSE}

mt<-read_df("/home/garofalo/analysis/heavy_quarks/data_Inc/out/cB211.072.64_ins48_ins64_th0.dat_output")
all_obs<- get_all_corr(mt)


df<-add_corr_to_df(string = "M_{Ds}_sl",all_obs=all_obs,mt=mt,df = NULL,
                   log = FALSE, number = NULL,nudge = 0,print_res = TRUE)

df<-add_corr_to_df("M_{Ds}_ss",all_obs,mt,df)
df<-add_corr_to_df("M_{K}_sl",all_obs,mt,df)
df<-add_corr_to_df("M_{K}_ss",all_obs,mt,df)
df<-add_corr_to_df("Z_{Ds}_ss",all_obs,mt,df)

# fit<-get_full_res(string="E3_0_vev",all_obs,mt,number=NULL)
# fit
# n<- which(all_obs[,"corr"]=="E3_0_vev")
# all_obs[n,"chi2.dof"]
gg<- plot_df_corr_ggplot(df)

fig<- myplotly(gg,paste0("meff"),"t", "$M_{eff}$", to_print=TRUE )
```

## tins 40-56

## $M_{\mu,\nu}$

```{r, echo=FALSE, results='asis', warning=FALSE}
mt<-read_df("/home/garofalo/analysis/heavy_quarks/data_Inc/out/cB211.072.64_ins40_ins56_th2.dat_output")
all_obs<- get_all_corr(mt)

df<-add_corr_to_df(string = "M_{0,0}",all_obs=all_obs,mt=mt,df = NULL,
                   log = FALSE, number = NULL,nudge = 0,print_res = TRUE)
for (mu in c(0:3)){
  for (nu in c(0:3)){
    if (mu==0 & nu==0 ) next
    name<-paste0("M_{",mu,",",nu,"}")
    df<-add_corr_to_df(name,all_obs,mt,df)
  }
}


# fit<-get_full_res(string="E3_0_vev",all_obs,mt,number=NULL)
# fit
# n<- which(all_obs[,"corr"]=="E3_0_vev")
# all_obs[n,"chi2.dof"]
gg<- plot_df_corr_ggplot(df)

fig<- myplotly(gg,paste0("meff"),"t", "$Re(M_{\\mu,\\nu})$", to_print=TRUE , 
               xrange=c(0,48), yrange=c(-1,1))
```



```{r, echo=FALSE, results='asis', warning=FALSE}
mt<-read_df("/home/garofalo/analysis/heavy_quarks/data_Inc/out/cB211.072.64_ins40_ins56_th2.dat_output")
all_obs<- get_all_corr(mt)

df<-add_corr_to_df(string = "ImM_{0,0}",all_obs=all_obs,mt=mt,df = NULL,
                   log = FALSE, number = NULL,nudge = 0,print_res = TRUE)
for (mu in c(0:3)){
  for (nu in c(0:3)){
    if (mu==0 & nu==0 ) next
    name<-paste0("ImM_{",mu,",",nu,"}")
    df<-add_corr_to_df(name,all_obs,mt,df)
  }
}

# df[,2]<-log10(abs(df[,2]))
# df[,3]<-(df[,3]/abs(df[,2]))

# fit<-get_full_res(string="E3_0_vev",all_obs,mt,number=NULL)
# fit
# n<- which(all_obs[,"corr"]=="E3_0_vev")
# all_obs[n,"chi2.dof"]
gg<- plot_df_corr_ggplot(df)

fig<- myplotly(gg,paste0("meff"),"t", "$Im(M_{\\mu,\\nu})$", to_print=TRUE ,
               xrange=c(0,48), yrange=c(-1,1))
```


### Z

```{r, echo=FALSE, results='asis', warning=FALSE}
ths<- c(2,4,6,8)
df<-data.frame()
for (th in ths){
  file<- paste0("/home/garofalo/analysis/heavy_quarks/data_Inc/out/cB211.072.64_ins40_ins56_th",th,".dat_output")
  mt<-read_df(file)
  all_obs<- get_all_corr(mt)

  dft<-add_corr_to_df(string = "Z_{0}",all_obs=all_obs,mt=mt,df = NULL,
                   log = TRUE, number = NULL,nudge = 0,print_res = TRUE)
  dft$th<- th
  df<- rbind (df,dft)
  
  dft<-add_corr_to_df(string = "Z_{1}",all_obs=all_obs,mt=mt,df = NULL,
                   log = TRUE, number = NULL,nudge = 0.1,print_res = TRUE)
  dft$th<- th
  df<- rbind (df,dft)
  dft<-add_corr_to_df(string = "Z_{2}",all_obs=all_obs,mt=mt,df = NULL,
                   log = TRUE, number = NULL,nudge = 0.2,print_res = TRUE)
  dft$th<- th
  df<- rbind (df,dft)
}
gg<- myggplot(fill = FALSE)+ geom_point(data=df , mapping=aes(x=x,y=y,
                                                          color=as.factor(th),
                                                          shape=label))
gg<- gg +  geom_errorbar(data=df , mapping=aes(x=x,ymax=y+err,ymin=y-err,
                                                          color=as.factor(th),
                                                          shape=label), width=0.55)

fig<- myplotly(gg,"","t", "$\\log(Z_0)$", to_print=TRUE , 
               xrange=c(0,40), yrange=c(-7,1))
```




### Comparing with Antonio 

$t_{sink}=64$ , $t_W=48$

```{r, echo=FALSE, results='asis', warning=FALSE}
mt<-read_df("/home/garofalo/analysis/heavy_quarks/data_Inc/out/cB211.072.64_ins48_ins64_th0.dat_output")
all_obs<- get_all_corr(mt)

df<-add_corr_to_df(string = "Z_{0}",all_obs=all_obs,mt=mt,df = NULL,
                   log = FALSE, number = NULL,nudge = 0,print_res = TRUE)

dfa<-read.table("/home/garofalo/Downloads/z0_iset0.dat")
gg<- plot_df_corr_ggplot(df)+xlim(0,48)
dfa<-dfa[-1,]
gg<-gg+geom_point(aes(x=dfa[,1], y=dfa[,2], color="Antonio"  ,shape="Antonio"   ,fill="Antonio"      ))
gg<-gg+geom_errorbar(aes(x=dfa[,1], ymin=dfa[,2]-dfa[,3]
                         , ymax=dfa[,2]+dfa[,3]
                         , color="Antonio"  ,shape="Antonio"   ,fill="Antonio"      ))
l<-df[c(1:40),2]/dfa[,2]
dfc<-read.table("/home/garofalo/Downloads/datacorr_t1_16_t2_42.csv", header = TRUE)
#gg<-gg+geom_point(aes(x=dfc[,1], y=dfc[,4], color="Christiane"  ,shape="Christiane"   ,fill="Christiane"      ))
#gg<-gg+geom_errorbar(aes(x=dfc[,1], ymin=dfc[,4]-dfc[,5]
#                         , ymax=dfc[,4]+dfc[,5]
#                         , color="Christiane"  ,shape="Christiane"   ,fill="Christiane"      ))


 #gg<-gg+ geom_point(aes(x=dfa[,1], y=l, color="ratio" ,shape="ratio"   ,fill="ratio") )
# gg<-gg+geom_error(aes(x=dfa[,1], ymin=dfa[,2]-dfa[,3],
#                     ymax=dfa[,2]+dfa[,3]
#                                                ),color="green")
gg<- gg+  scale_y_continuous(trans='log')

fig<- myplotly(gg,"","t", "$\\log(Z_0)$", to_print=TRUE , 
               xrange=c(0,48))
```